# Wi-Fi Audit Tool

A modular Wi-Fi auditing toolkit built using **Scapy**, with support for:

* RSN/WPA2/WPA3 information extraction
* EAP/EAPOL handshake summarization
* MAC anonymization for safe sharing
* CSV/JSON exports
* PCAP rewriting

## âœ¨ Features

### 1. RSN (WPA2/WPA3) Information Extraction

Extracts AP security information including:

* RSN version
* Group cipher
* Pairwise cipher suites
* AKM suites (EAP, PSK, SAE, OWE, etc.)
* MFPC/MFPR capability flags

Implemented in `rsn_parser.py` .

---

### 2. EAP/EAPOL Summarization

Summarizes client-side authentication events:

* EAP Identity
* TLS / TTLS / PEAP / MSCHAPv2
* EAP Start detection
* Outer TLS observation
* 4-way handshake presence
* Timestamp logs

Implemented in `eap_summarizer.py` .

---

### 3. PCAP Anonymization

Deterministically pseudonymizes all MAC addresses using HMAC-SHA256 while preserving relationships:

* Rewrites Dot11 addr fields
* Redacts EAP Identity strings
* Produces an anonymized PCAP + mapping file

Implemented in `anonymizer.py` .

---

### 4. JSON/CSV Export Utilities

Supports writing:

* JSON summaries
* CSV tables for RSN Information

Flattening includes:

* RSN ciphers
* AKM suites
* MFPC/MFPR
* ISO timestamps

Implemented in `io_utils.py` .

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ main.py
â”œâ”€â”€ parsers/
â”‚   â”œâ”€â”€ rsn_parser.py
â”‚   â””â”€â”€ eap_summarizer.py
â””â”€â”€ utils/
    â”œâ”€â”€ anonymizer.py
    â””â”€â”€ io_utils.py
```

---

## ğŸ›  Requirements

* Python 3.8+
* Scapy

Install dependencies:

```bash
pip install scapy
```

---

## ğŸš€ Usage

Run the tool:

```bash
python3 main.py input.pcap
```

Prompt options:

```
1. Extract RSN Info
2. Summarize EAP/EAPOL
3. Anonymize PCAP
```

Use multiple selections like:

```
1 2
```

---

## ğŸ“¤ Output Formats

### RSN CSV Output

Contains (per BSSID):

* SSID
* Channel
* RSN version
* Group cipher
* Pairwise ciphers
* AKM suites
* MFPC / MFPR
* First seen timestamp

---

### EAP Summary (JSON)

Per-client details:

* EAP types (Identity, TLS, TTLS, PEAP, MSCHAPv2â€¦)
* Timestamps
* EAP Start
* Outer TLS observed
* 4-way handshake observed

Generated by `eapol_summarizer()` .

---

### PCAP Anonymization Output

Produces:

* `anon.pcap` â€” MACs rewritten
* `mapping.json` â€” original â†’ pseudonym mapping

Pseudonyms are derived using:

```
HMAC_SHA256(seed, mac) â†’ 6-byte address
```

Implemented in `mac_pseudonym()` and `anonymize_pcap()` .

---

## ğŸ§© Internal Details

### RSN IE Parsing

`parse_rsn_ie()` reads:

1. Version
2. Group cipher
3. Pairwise cipher list
4. AKM suite list
5. Optional RSN capabilities

Cipher and AKM mappings follow the IEEE OUI table.
Defined in `rsn_parser.py` .

---

### EAP/EAPOL Logic

* `type=None` â†’ EAP Start
* `type=1` â†’ Identity
* `type={13,21,25}` â†’ TLS/TTLS/PEAP
* `EAPOL.type==3` â†’ 4-way handshake presence

Converted timestamps use RFC3339 UTC formatting.

---

### MAC Pseudonymization

Uses deterministic anonymization:

```
HMAC_SHA256(seed, input_mac)[:6]
```

Ensures:

* Locally administered MAC bit is set
* Same real MAC â†’ same pseudonym

Defined in `anonymizer.py` .

---

## ğŸ§ª Example Workflows

### Extract RSN Info

```bash
python3 main.py campus.pcap
# choose: 1
# output: rsn.csv
```

### Summarize EAP Activity

```bash
python3 main.py eduroam_capture.pcap
# choose: 2
# output: eap.json
```

### Anonymize a PCAP

```bash
python3 main.py sensitive.pcap
# choose: 3
# seed: research-seed
# outputs: anon.pcap, mapping.json
```

---

## ğŸ“Œ Notes

* Some malformed frames may be ignored by Scapy.
* RSN parsing works only on Beacon/Probe Response frames.
* Anonymization does **not** preserve cryptographic handshake integrity (PMKID, MIC, etc).

## ğŸ‘¥ Contributors

Primary Contributors
Harshwardhan Gaikwad â€“ Project design, code development, wireless security analysis, documentation.
Devagya - Code Development and documentation

---




